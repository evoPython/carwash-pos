<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carwash POS Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tables.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modals.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/forms.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/notifications.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='js/tabulator/tabulator.min.css') }}" />
</head>

<body>
    <header>
        <div class="header-center">
            <h1>Carwash POS</h1>
        </div>
        <div class="header-right">
            {% if current_user.has_permission(80) %}
            <a href="{{ url_for('summary') }}" class="btn">Summary</a>
            <a href="{{ url_for('users') }}" class="btn">Manage Users</a>
            {% endif %}
            {% if current_user.role == 'Developer' %}
            <a href="{{ url_for('database') }}" class="btn">Database</a>
            {% endif %}
            <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
        </div>
    </header>

    <div class="user-section">
        <div class="user-name">{{ current_user.full_name }}</div>
        <div class="user-role {{ current_user.role.lower() }}">{{ current_user.role }}</div>
        {% if current_user.role == 'Incharge' %}
        <div id="user-shift" style="display: none;">{{ current_user.shift }}</div>
        {% endif %}
        <div id="current-datetime" class="current-datetime"></div>
    </div>

    <main>
        {% if current_user.has_permission(80) %}
        <section class="controls">
            <div class="filter">
                <!-- <label>Date:</label>
                <input type="date" id="filter-date" /> -->
                <label>Month:</label>
                <input type="month" id="filter-month" />
                <button id="btn-refresh" class="btn">Refresh</button>
            </div>
            <div class="summary">
                <!-- Income Group -->
                <div class="card gross">
                    <h2>Gross Income</h2>
                    <p id="sum-income">₱ placeholder</p>
                </div>
                <div class="card net">
                    <h2>Net Income</h2>
                    <p id="sum-net">₱ placeholder</p>
                </div>
                <div class="card expense">
                    <h2>Expenses</h2>
                    <p id="sum-expenses">₱ placeholder</p>
                </div>
                <div class="card share-ceta">
                    <h2>Cetadcco Share</h2>
                    <p id="sum-cetadcco">₱ placeholder</p>
                </div>
                <div class="card share-carw">
                    <h2>Carwasher Share</h2>
                    <p id="sum-carwasher">₱ placeholder</p>
                </div>
            </div>
        </section>
        {% endif %}

        <section class="table-section">
            <h2 class="centered-header" id="previous-shift-header" style="display: none;">Previous Shift:</h2>
            <div id="orders-table"></div>
        </section>

        <section class="new-order-section">
            <button id="btn-open-modal" class="btn-primary">New Order</button>
            <button id="btn-temporary" class="btn-primary" style="display: none;">Temporary Button</button>
        </section>

        <div id="shift-timer" class="shift-timer"></div>
    </main>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span id="modal-close" class="modal-close">&times;</span>
            <h2>New Order</h2>
            <form id="order-form">
                <div class="form-row">
                    <label>
                        Vehicle Type
                        <select id="vehicle-type" required>
                            <option value="" disabled selected>Choose vehicle type</option>
                        </select>
                    </label>
                </div>

                <div class="form-row">
                    <label>Base Service</label>
                    <div class="base-service-radio">
                        <label class="radio-label">
                            <input type="radio" name="base-service" value="Bodywash" required>
                            Bodywash
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="base-service" value="Bodywash with Vacuum">
                            Bodywash with Vacuum
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="base-service" value="Vacuum Only">
                            Vacuum Only
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="base-service" value="Spray Only">
                            Spray Only
                        </label>
                    </div>
                </div>

                <div class="form-row">
                    <label>
                        Plate No.
                        <input type="text" id="plate-no" required placeholder="Enter plate number" />
                    </label>
                    <label>
                        Price (₱)
                        <input type="number" id="price" required min="40" step="0.01"
                            placeholder="Price will be set automatically" readonly />
                    </label>
                    <label>
                        W/Vac
                        <div class="toggle-switch">
                            <input type="checkbox" id="w-vac" />
                            <span class="toggle-slider"></span>
                        </div>
                    </label>
                </div>

                <div class="form-row">
                    <label>Additional Services</label>
                    <div class="addon-checkboxes">
                    </div>
                </div>

                <div class="form-row">
                    <label>
                        Less 40 (₱)
                        <input type="number" id="less-40" value="40" readonly />
                    </label>
                    <label>
                        C-Shares (₱)
                        <input type="number" id="c-shares" readonly />
                    </label>
                </div>

                <div class="form-row">
                    <label>
                        W-Share (₱)
                        <input type="number" id="w-share" readonly />
                    </label>
                    <label>
                        W-Name
                        <input type="text" id="w-name" value="{{ current_user.full_name }}" readonly />
                    </label>
                </div>

                <div class="form-row">
                    <label>
                        SSS (₱)
                        <input type="number" id="sss" value="2" readonly />
                    </label>
                </div>

                <div style="text-align: center; margin-top: 1.5rem;">
                    <button type="submit" class="btn-primary" style="padding: 0.7rem 2rem; font-size: 1rem;">Add
                        Order</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Temporary Button Modal -->
    <div id="temporary-modal" class="modal">
        <div class="modal-content">
            <span id="temporary-modal-close" class="modal-close">&times;</span>
            <h2>Placeholder</h2>
            <form id="temporary-form">
                <div class="form-row">
                    <div class="form-column">
                        <!-- First Column, labelled 'SALES'-->
                        <h3>SALES</h3>
                        <div class="form-row">
                            <label>
                                Total Gross Sales
                                <input type="number" id="total-gross-sales" value="" readonly />
                            </label>
                        </div>
                        <div class="form-row">
                            <label>
                                40x
                                <input type="number" id="40x" value="" readonly />
                            </label>
                        </div>
                        <h3>ADDONS</h3>
                        <div id="addons-container">
                            <!-- Addons will be dynamically inserted here -->
                        </div>
                    </div>

                    <div class="vertical-separator"></div>

                    <div class="form-column">
                        <!-- Second Column, labelled 'OTHER INCOME'-->
                        <h3>OTHER INCOME</h3>
                        <div class="form-row">
                            <!-- Button 'Add Other Income' -->
                            <button id="add-other-income" class="btn-secondary">+ Add Other Income</button>
                            <div id="other-income-dropdown" class="dropdown" style="display: none;">
                                <button class="dropdown-item" data-value="Canteen">Canteen</button>
                                <button class="dropdown-item" data-value="Water">Water</button>
                            </div>
                        </div>

                        <h3>EXPENSES</h3>

                        <div class="form-row">
                            <!-- Table with Name, Description, Amount -->
                            <table id="expenses-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th>Amount</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rows will be added dynamically -->
                                </tbody>
                            </table>
                        </div>

                        <div class="form-row">
                            <!-- Button 'Add Expense' -->
                            <button id="add-expense" class="btn-secondary">+ Add Expense</button>
                        </div>

                        <div class="form-row">
                            <label>
                                Wages
                                <input type="number" id="wages" value="" readonly />
                            </label>
                            <label>
                                GCash
                                <input type="number" id="gcash" value="" />
                            </label>
                        </div>

                        <div class="form-row">
                            <label>
                                Total
                                <span id="grand-total">₱0.00</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 1.5rem;">
                    <button type="button" id="temporary-modal-submit" class="btn-primary">Submit</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/chart.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tabulator/tabulator.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/notifications.js') }}"></script>
    <script src="{{ url_for('static', filename='js/time_override.js') }}"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>